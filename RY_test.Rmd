---
title: "RY_test"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#load package
```{r}
library(readxl)
library(tidyverse)
library(lavaan)
library(psych)
library(Hmisc)
library(apaTables)
```


#read_data
```{r}
P2<-read_excel("NIHP2LanguageReadingSDS300.xlsx")
```

#tidy
```{r}
names(P2)<-str_replace_all(names(P2), c(" " = "" )) 
```

#correlation_function
```{r}
#Function that helps formating  matrix
# ++++++++++++++++++++++++++++
# flattenCorrMatrix
# ++++++++++++++++++++++++++++
# cormat : matrix of the correlation coefficients
# pmat : matrix of the correlation p-values
flattenCorrMatrix <- function(cormat, pmat) {
  ut <- upper.tri(cormat)
  data.frame(
    row = rownames(cormat)[row(cormat)[ut]],
    column = rownames(cormat)[col(cormat)[ut]],
    cor  =(cormat)[ut],
    p = round(pmat[ut],2)
    )
}
```



#EDA
```{r}
corP2 <- P2 %>%
  mutate(DELVSTrisk1R=17-DELVSTrisk1,DELVSTrisk3R=17-DELVSTrisk3)%>%
  select(-Ethnicity,-ChildId, -Gender)
cormatrix<-rcorr(as.matrix(corP2))
matrixcorrelation2<-flattenCorrMatrix(cormatrix$r,cormatrix$P)

meanP2<-colMeans(corP2)
sdP2<-apply(corP2,2,sd)


#reverse Delvrisk
#write sd,m into a table
#put correlation, sd, M in a table--> Descriptive Table


apa.cor.table(corP2, filename="SDS300_corTable1.doc", table.number=1)

```

#