---
title: "Graphs"
author: "Shengqi(Iris) Zhong"
date: "4/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
```

## Have a look at the dataset
```{r import dataset}
library(readxl)
p2 <- read_excel("NIHP2LanguageReadingSDS300.xlsx") %>%
  rename(IQ = `NVIQ SS`) %>%
  mutate(Intervention = as.factor(Intervention))
head(p2)
```

## Graphs
### Gender
```{r gender plot}
gender_plot <- ggplot(p2,aes(x = Gender)) +
  geom_histogram(stat = "count")
gender_plot
```

### Ethnicity
```{r ethnicity plot}
ethnicity_plot <- ggplot(p2,aes(x = Ethnicity)) +
  geom_histogram(stat = "count")
ethnicity_plot
```

### IQ
```{r IQ plot}
iq_plot <- ggplot(p2,aes(x = IQ)) +
  geom_histogram(breaks = seq(50, 160, by = 5)) +
  geom_vline(xintercept = mean(p2$IQ, na.rm = T),
             color = "coral", linetype = "dashed", size = 1)
iq_plot
```

```{r IQ ~ ethnicity plot}
ggplot(p2,aes(x = IQ, fill = Ethnicity, color = Ethnicity)) +
  geom_histogram(breaks = seq(50, 160, by = 5),
                 aes(y = ..density..),
                 position = "identity",
                 alpha = 0.5) +
  geom_vline(xintercept = mean((p2 %>% filter(Ethnicity == "BLACK"))$IQ),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((p2 %>% filter(Ethnicity == "WHITE"))$IQ),
             color = "blue", linetype = "dashed", size = 1)

```

### Verbal rote memory subtest (Wspan)

```{r wspan plot}
wspan_plot <- ggplot(p2,aes(x = Wspan)) +
  geom_histogram(stat = "count") +
  geom_vline(xintercept = mean(p2$Wspan, na.rm = T),
             color = "coral", linetype = "dashed", size = 1)
wspan_plot
```

#### not useful

```{r wspan ~ ethnicity plot}
ggplot(p2,aes(x = Wspan, fill = Ethnicity, color = Ethnicity)) +
  geom_histogram(position = "identity") +
  geom_vline(xintercept = mean((p2 %>% filter(Ethnicity == "BLACK"))$Wspan, 
                               na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((p2 %>% filter(Ethnicity == "WHITE"))$Wspan),
             color = "blue", linetype = "dashed", size = 1)
```


### DELV score

```{r}
delv_data <- p2 %>%
  select(Intervention, DELVSTrisk1, DELVSTrisk3) %>%
  pivot_longer(cols = c("DELVSTrisk1", "DELVSTrisk3"), names_to = "phase", values_to = "score") %>%
  mutate(phase = as.factor(phase))

ggplot(delv_data, aes(x = score, fill = phase, color = phase)) +
  geom_histogram(position = "identity", breaks = seq(0, 12, by = 1.5),
                 aes(y = ..density..),
                 alpha = 0.5)+
  geom_vline(xintercept = mean((delv_data %>% filter(phase == "DELVSTrisk1"))$score, na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((delv_data %>% filter(phase == "DELVSTrisk3"))$score, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
```

```{r DELV diff}
delv_data_diff <- p2 %>%
  select(Gender, Intervention, Ethnicity, DELVSTrisk1, DELVSTrisk3) %>%
  mutate(delv_diff = DELVSTrisk1 - DELVSTrisk3,
         Intervention = as.factor(Intervention))

ggplot(delv_data_diff, aes(x = delv_diff)) +
  geom_histogram(breaks = seq(-5, 12, by = 1),
                 aes(y = ..density..)) +
  facet_wrap(~Intervention) +
  coord_flip() +
  geom_vline(xintercept = 0,
             col = "coral", size = 1, linetype = "dashed")
  

```

### Expressive score
```{r expressive}
expressive_data <- p2 %>%
  select(Intervention, EOWPVTESS1, EOWPVTESS3) %>%
  pivot_longer(cols = c("EOWPVTESS1", "EOWPVTESS3"), names_to = "phase", values_to = "score") %>%
  mutate(phase = as.factor(phase))

ggplot(expressive_data, aes(x = score, fill = phase, color = phase)) +
  geom_histogram(position = "identity",
                 aes(y = ..density..),
                 alpha = 0.5)+
  geom_vline(xintercept = mean((expressive_data %>% filter(phase == "EOWPVTESS1"))$score, 
                               na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((expressive_data %>% filter(phase == "EOWPVTESS3"))$score, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
```

```{r expressive diff}
expressive_data_diff <- p2 %>%
  select(Gender, Intervention, Ethnicity, EOWPVTESS1, EOWPVTESS3) %>%
  mutate(expressive_diff = EOWPVTESS3 - EOWPVTESS1)

ggplot(expressive_data_diff, aes(x = expressive_diff)) +
  geom_histogram(aes(y = ..density..)) +
  facet_wrap(~Intervention) +
  coord_flip() +
  geom_vline(xintercept = 0,
             col = "coral", size = 1, linetype = "dashed")
  

```

### Phonological Awareness

```{r pa}
pa_data <- p2 %>%
  select(Intervention, TOPLPASS1, TOPLPASS3) %>%
  pivot_longer(cols = c("TOPLPASS1", "TOPLPASS3"), names_to = "phase", values_to = "score") %>%
  mutate(phase = as.factor(phase))

ggplot(expressive_data, aes(x = score, fill = phase, color = phase)) +
  geom_histogram(position = "identity",
                 aes(y = ..density..),
                 alpha = 0.5)+
  geom_vline(xintercept = mean((pa_data %>% filter(phase == "TOPLPASS1"))$score, 
                               na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((pa_data %>% filter(phase == "TOPLPASS3"))$score, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
```

```{r pa diff}
pa_data_diff <- p2 %>%
  select(Intervention, TOPLPASS1, TOPLPASS3) %>%
  mutate(pa_diff = TOPLPASS3 - TOPLPASS1,
         Intervention = as.factor(Intervention))

ggplot(pa_data_diff, aes(x = pa_diff)) +
  geom_histogram(aes(y = ..density..)) +
  facet_wrap(~Intervention) +
  coord_flip() +
  geom_vline(xintercept = 0,
             col = "coral", size = 1, linetype = "dashed")

ggplot(pa_data_diff, aes(x = pa_diff, fill = Intervention, color = Intervention)) +
  geom_histogram(position = "identity",
                 aes(y = ..density..),
                 alpha = 0.5)+
  geom_vline(xintercept = mean((pa_data_diff %>% filter(Intervention == "0"))$pa_diff, na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((pa_data_diff %>% filter(Intervention == "1"))$pa_diff, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
  

```

### Woodcock Johnson III Letter-Word test

```{r letter-word}
ggplot(p2, aes(x = WJ3LWSS5, fill = Intervention, color = Intervention)) +
  geom_histogram(aes(y = ..density..),
                 position = "identity",
                 alpha = 0.5)+
  geom_vline(xintercept = mean((p2 %>% filter(Intervention == "0"))$WJ3LWSS5, na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((p2 %>% filter(Intervention == "1"))$WJ3LWSS5, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
```


### WJIII Passage Comprehension
```{r passage comprehension}
ggplot(p2, aes(x = WJ3PComSS5, fill = Intervention, color = Intervention)) +
  geom_histogram(aes(y = ..density..),
                 position = "identity",
                 alpha = 0.5)+
  geom_vline(xintercept = mean((p2 %>% filter(Intervention == "0"))$WJ3PComSS5, na.rm = T),
             color = "red", linetype = "dashed", size = 1) +
  geom_vline(xintercept = mean((p2 %>% filter(Intervention == "1"))$WJ3PComSS5, na.rm = T),
             color = "blue", linetype = "dashed", size = 1)
```

